module.exports=[37936,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"registerServerReference",{enumerable:!0,get:function(){return d.registerServerReference}});let d=a.r(11857)},13095,(a,b,c)=>{"use strict";function d(a){for(let b=0;b<a.length;b++){let c=a[b];if("function"!=typeof c)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof c}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ensureServerEntryExports",{enumerable:!0,get:function(){return d}})},43840,20365,a=>{"use strict";var b=a.i(37936),c=a.i(16349),d=a.i(13095);async function e(a){try{let b=await (0,c.createClient)(),d=a.trim(),{data:e,error:f}=await b.from("loyalty_redemptions").select(`
        id,
        user_id,
        reward_id,
        points_spent,
        status,
        created_at,
        loyalty_rewards (
          name
        )
      `).eq("qr_code",d).single();if(f||!e)return{success:!1,error:f?.message||"Codigo QR no encontrado"};if("pending"!==e.status)return{success:!1,error:"validated"===e.status?"Este codigo ya fue utilizado":"cancelled"===e.status?"Este codigo ha sido cancelado":"Este codigo no esta disponible"};return{success:!0,redemption:{id:e.id,user_id:e.user_id,reward_id:e.reward_id,reward_name:e.loyalty_rewards?.name||"Producto",points_spent:e.points_spent,status:e.status,created_at:e.created_at}}}catch(a){return console.error("Error validando redencion:",a),{success:!1,error:"Error inesperado al validar el codigo"}}}async function f(a,b){try{let d=await (0,c.createClient)(),{data:{user:e},error:f}=await d.auth.getUser();if(f||!e)return{success:!1,error:"No se pudo autenticar"};let{error:g}=await d.from("loyalty_redemptions").update({status:"validated",validated_at:new Date().toISOString(),order_id:b||null}).eq("id",a);if(g)return{success:!1,error:"Error al procesar la redencion"};return{success:!0}}catch(a){return console.error("Error inesperado:",a),{success:!1,error:"Error inesperado"}}}async function g(a,b){try{let c=await e(a);if(!c.success||!c.redemption)return{success:!1,error:c.error||"Codigo QR invalido"};let d=await f(c.redemption.id,b);if(!d.success)return{success:!1,error:d.error||"Error al procesar la redencion"};return{success:!0,redemption:c.redemption}}catch(a){return console.error("Error procesando redencion:",a),{success:!1,error:"Error inesperado al procesar la redencion"}}}(0,d.ensureServerEntryExports)([e,f]),(0,b.registerServerReference)(e,"408093cec055993d27ccf31b16553a83b925d68f64",null),(0,b.registerServerReference)(f,"602417138fa92969a2130e4c4a216d6c6c078ff7c4",null),a.s(["markRedemptionAsUsed",()=>f,"validateRedemption",()=>e],43840),(0,d.ensureServerEntryExports)([g]),(0,b.registerServerReference)(g,"606344c6f1116c1de062d21a4b4bdf4d2412f5c316",null),a.s(["processRedemptionAction",()=>g],20365)},58005,a=>{"use strict";var b=a.i(43840),c=a.i(20365);a.s([],21014),a.i(21014),a.s(["408093cec055993d27ccf31b16553a83b925d68f64",()=>b.validateRedemption,"606344c6f1116c1de062d21a4b4bdf4d2412f5c316",()=>c.processRedemptionAction],58005)}];

//# sourceMappingURL=_15859512._.js.map